# ุฎูุงุตู ฺฉุงูู ุฑูุน ูุดฺฉู ฺุฑุฎู ููุชโฺฏุฐุงุฑ

## ๐ฏ ูุชุฌู ฺฉุงุฑ

**ูุดฺฉู:** ฺุฑุฎู ููุชโฺฏุฐุงุฑ ุงุฒ ุซุจุช ููุช ุชุง ุซุจุช ุณูุงุฑุด ุดฺฉุณุชู ุจูุฏ

**ูุถุนุช:** โ **ุญู ุดุฏ - ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู**

---

## ๐ ุฎูุงุตู ูุดฺฉู

ุฒูุงู ฺฉู ูุฏุฑ ุฏุฑ ูุฑู ุซุจุช ููุช (`[tabesh_product_pricing]`) ฺฉ pricing matrix ูุงูุต (ุจุฏูู page_costs ุง binding_costs ฺฉุงูู) ุฐุฎุฑู ูโฺฉุฑุฏ:

1. โ ูฺ ูุดุฏุงุฑ ููุงุด ุฏุงุฏู ููโุดุฏ
2. โ ูุทุน ุฏุฑ ูุฑู ุณูุงุฑุด (`[tabesh_order_form_v2]`) ููุงุด ุฏุงุฏู ูโุดุฏ
3. โ ฺฉุงุฑุจุฑ ูุทุน ุฑุง ุงูุชุฎุงุจ ูโฺฉุฑุฏ ุงูุง ูฺ paper/binding ููุฌูุฏ ูุจูุฏ
4. โ ูุฑู ุณูุงุฑุด ฺฉุงุฑ ููโฺฉุฑุฏ
5. โ ฺุฑุฎู ฺฉุงูู ุดฺฉุณุชู ุจูุฏ

---

## ๐ง ุฑุงูโุญู ูพุงุฏูโุณุงุฒ ุดุฏู

### 1. ุฑูุน ุจุงฺฏ ุงุตู ุฏุฑ Constraint Manager

**File:** `includes/handlers/class-tabesh-constraint-manager.php`
**Method:** `get_available_book_sizes()`

**ุชุบุฑ ฺฉูุฏ:**
```php
// ูุจู - ููุดู true
'enabled' => true,

// ุจุนุฏ - ููุท ุฒูุงู true ฺฉู ุฏุงุฏู ฺฉุงูู ุจุงุดุฏ
$is_usable = ( $paper_count > 0 && $binding_count > 0 );
'enabled' => $is_usable,
```

**ูุชุฌู:** ููุท ูุทุนโูุง ฺฉู ูู papers ู ูู bindings ุฏุงุฑูุฏ ุฏุฑ order form ููุงุด ุฏุงุฏู ูโุดููุฏ.

### 2. ุงุถุงูู ฺฉุฑุฏู Validation ุจู Product Pricing Form

**File:** `includes/handlers/class-tabesh-product-pricing.php`
**Method:** `handle_save_pricing()`

**ุงูุฒูุฏู ุดุฏู:**
- ุจุฑุฑุณ ุงูฺฉู matrix ุญุฏุงูู ฺฉ paper_cost ู ฺฉ binding_cost ุฏุงุฑุฏ
- ููุงุด warning ุจู ูุฏุฑ ุงฺฏุฑ matrix ูุงูุต ุจุงุดุฏ
- ุชูุถุญ ุตุฑุญ ฺฉู ุงู ูุทุน ุฏุฑ order form ููุงุด ุฏุงุฏู ูุฎูุงูุฏ ุดุฏ

**ูพุงูโูุง ุฌุฏุฏ:**
```
โ๏ธ ูุดุฏุงุฑ: ูุงุชุฑุณ ููุช ูุงูุต ุงุณุช!
ููุงุฑุฏ ุฒุฑ ุชูุธู ูุดุฏูโุงูุฏ: ููุช ุตุญุงู
ุงู ูุทุน ุฏุฑ ูุฑู ุณูุงุฑุด ููุงุด ุฏุงุฏู ูุฎูุงูุฏ ุดุฏ.
```

### 3. ุจูุจูุฏ UI - ุงุถุงูู ฺฉุฑุฏู CSS Class

**File:** `assets/css/product-pricing.css`

ุงุถุงูู ุดุฏ ฺฉูุงุณ `.tabesh-warning` ุจุฑุง ููุงุด ูพุงูโูุง ูุดุฏุงุฑ ุจุง ุฑูฺฏ ุฒุฑุฏ.

---

## โ ุชุณุชโูุง ุงูุฌุงู ุดุฏู

### ุณูุงุฑู 1: Matrix ฺฉุงูู
```
Setup: A5 ุจุง papers + bindings
Result: โ ุฏุฑ order form ููุงุด ุฏุงุฏู ูโุดูุฏ
```

### ุณูุงุฑู 2: Matrix ูุงูุต (ููุท papers)
```
Setup: A4 ุจุง papersุ ุจุฏูู bindings
Result: โ ุฏุฑ order form ููุงุด ุฏุงุฏู ููโุดูุฏ
Warning: โ ูุฏุฑ ูุดุฏุงุฑ ูโุจูุฏ
```

### ุณูุงุฑู 3: Matrix ูุงูุต (ููุท bindings)
```
Setup: ุฑูุน ุจุง bindingsุ ุจุฏูู papers
Result: โ ุฏุฑ order form ููุงุด ุฏุงุฏู ููโุดูุฏ
Warning: โ ูุฏุฑ ูุดุฏุงุฑ ูโุจูุฏ
```

### ุณูุงุฑู 4: ุจุฏูู Matrix
```
Setup: ูุฒุฑ ุจุฏูู ูฺ pricing matrix
Result: โ ุฏุฑ order form ููุงุด ุฏุงุฏู ููโุดูุฏ
```

---

## ๐ ูุงูโูุง ุชุบุฑ ุงูุชู

1. โ `includes/handlers/class-tabesh-constraint-manager.php`
2. โ `includes/handlers/class-tabesh-product-pricing.php`
3. โ `assets/css/product-pricing.css`
4. โ `PRICING_CYCLE_FIX_COMPLETE.md` (ูุณุชูุฏุงุช ูุงุฑุณ)
5. โ `PRICING_CYCLE_FIX_COMPLETE_EN.md` (ูุณุชูุฏุงุช ุงูฺฏูุณ)

---

## ๐งช ูุญูู ุชุณุช ุฏุณุช

### ฺฏุงู 1: ุชุณุช Matrix ูุงูุต
1. ุจู `wp-admin/admin.php?page=tabesh-product-pricing` ุจุฑูุฏ
2. ูุทุน A5 ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
3. ููุท ฺฉ paper cost ูุงุฑุฏ ฺฉูุฏ (binding ุฎุงู ุจฺฏุฐุงุฑุฏ)
4. Save ฺฉูุฏ
5. **ุงูุชุธุงุฑ:** ุจุงุฏ warning ุฒุฑุฏ ุจุจูุฏ
6. ุจู order form ุจุฑูุฏ
7. **ุงูุชุธุงุฑ:** A5 ูุจุงุฏ ุฏุฑ dropdown ุจุงุดุฏ

### ฺฏุงู 2: ุชุณุช Matrix ฺฉุงูู
1. ุจู Product Pricing ุจุฑฺฏุฑุฏุฏ
2. A5 ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
3. ูู papers ู ูู bindings ุฑุง ฺฉุงูู ฺฉูุฏ
4. Save ฺฉูุฏ
5. **ุงูุชุธุงุฑ:** ูพุงู ููููุช ุณุจุฒ ุจุฏูู warning
6. ุจู order form ุจุฑูุฏ
7. **ุงูุชุธุงุฑ:** A5 ุจุงุฏ ุฏุฑ dropdown ุจุงุดุฏ

### ฺฏุงู 3: ุชุณุช ุณูุงุฑุด ฺฉุงูู
1. ุฏุฑ order formุ A5 ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
2. Paper type ู weight ุงูุชุฎุงุจ ฺฉูุฏ
3. **ุงูุชุธุงุฑ:** options ููุฌูุฏ ุจุงุดุฏ
4. Binding ุงูุชุฎุงุจ ฺฉูุฏ
5. **ุงูุชุธุงุฑ:** cover weights ููุฌูุฏ ุจุงุดุฏ
6. ูุฑู ุฑุง ฺฉุงูู ฺฉูุฏ
7. **ุงูุชุธุงุฑ:** ููุช ูุญุงุณุจู ู ุณูุงุฑุด ุซุจุช ุดูุฏ

---

## ๐ ุนุจโุงุจ

### ูุดฺฉู: ูฺ ูุทุน ุฏุฑ order form ูุณุช

**ุฑุงูโุญูโูุง ุงุญุชูุงู:**

1. **ุจุฑุฑุณ Product Parameters:**
   - ุจู `Settings โ Product Parameters` ุจุฑูุฏ
   - ูุทูุฆู ุดูุฏ book sizes ุชุนุฑู ุดุฏูโุงูุฏ

2. **ุจุฑุฑุณ Pricing Matrices:**
   - ุจู `Product Pricing` ุจุฑูุฏ
   - ุจุฑุง ูุฑ ูุทุนุ ูู papers ู ูู bindings ุฑุง ุชูุธู ฺฉูุฏ

3. **ุจุฑุฑุณ Pricing Engine:**
   - ุจู `Product Pricing` ุจุฑูุฏ
   - ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู "ููุชูุฑ ุฌุฏุฏ (V2) ูุนุงู" ุงุณุช

4. **ุจุฑุฑุณ Logs:**
   - `WP_DEBUG` ุฑุง ูุนุงู ฺฉูุฏ
   - `wp-content/debug.log` ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุจู ุฏูุจุงู ูพุงูโูุง `Tabesh Constraint Manager` ุจฺฏุฑุฏุฏ

---

## ๐ ููุงุณู ูุจู ู ุจุนุฏ

### ูุจู ุงุฒ ุฑูุน โ
```
1. ูุฏุฑ matrix ูุงูุต ุฐุฎุฑู ูโฺฉูุฏ
2. ูฺ warning ููโุจูุฏ
3. ูุทุน ุฏุฑ order form ุธุงูุฑ ูโุดูุฏ
4. ฺฉุงุฑุจุฑ ูุทุน ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ
5. ูฺ paper/binding ููุฌูุฏ ูุณุช
6. ูุฑู ฺฉุงุฑ ููโฺฉูุฏ
7. ฺุฑุฎู ุดฺฉุณุชู ุงุณุช โ
```

### ุจุนุฏ ุงุฒ ุฑูุน โ
```
1. ูุฏุฑ matrix ูุงูุต ุฐุฎุฑู ูโฺฉูุฏ
2. Warning ูุงุถุญ ูโุจูุฏ
3. ูุทุน ุฏุฑ order form ุธุงูุฑ ููโุดูุฏ
4. ฺฉุงุฑุจุฑ ููโุชูุงูุฏ ูุทุน ูุงูุต ุงูุชุฎุงุจ ฺฉูุฏ
5. ููุท ูุทุนโูุง ฺฉุงูู ูุงุจู ุงูุชุฎุงุจ ูุณุชูุฏ
6. ูุฑู ฺฉุงูู ฺฉุงุฑ ูโฺฉูุฏ
7. ฺุฑุฎู ุณุงูู ุงุณุช โ
```

---

## ๐ ุงููุช

- โ ููู ูุฑูุฏโูุง sanitized
- โ ููู ุฎุฑูุฌโูุง escaped
- โ ุจุฏูู ุชุบุฑ ุฏุฑ database queries ููุฌูุฏ
- โ ููุท validation logic ุงุถุงูู ุดุฏ
- โ ุจุฏูู ูุดฺฉู ุงููุช

---

## ๐ ูุถุนุช ููุง

**โ ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ production**

**ฺุฑุฎู ููุชโฺฏุฐุงุฑ ุญุงูุง:**
- โ ฺฉุงููุงู ฺฉุงุฑุจุฑุฏ ุงุณุช
- โ ุงุฒ ุฏุงุฏูโูุง ูุงูุต ุฌููฺฏุฑ ูโฺฉูุฏ
- โ ุจู ูุฏุฑุงู feedback ูุงุถุญ ูโุฏูุฏ
- โ ุชุฌุฑุจู ฺฉุงุฑุจุฑ ุจูุชุฑ ุฏุงุฑุฏ
- โ ูพุงุฏุงุฑ ู ูุงุจู ุงุนุชูุงุฏ ุงุณุช

---

## ๐ ูุณุชูุฏุงุช

ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑ:
- **ูุงุฑุณ:** `PRICING_CYCLE_FIX_COMPLETE.md`
- **ุงูฺฏูุณ:** `PRICING_CYCLE_FIX_COMPLETE_EN.md`

---

**ุชุงุฑุฎ ุฑูุน:** 2025-12-19
**ูุณุฎู:** Tabesh 1.0.4+
**ูุถุนุช:** โ ูุดฺฉู ุญู ุดุฏ
