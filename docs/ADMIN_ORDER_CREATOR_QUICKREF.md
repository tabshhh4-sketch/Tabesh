# Admin Order Creator - Quick Reference

## تنظیم اولیه (Setup)

### فعال‌سازی
ویژگی به صورت خودکار با به‌روزرسانی افزونه فعال می‌شود. نیازی به تنظیمات اضافی نیست.

### دسترسی
فقط کاربران با دسترسی `manage_woocommerce` یا کاربران در لیست `admin_dashboard_allowed_users` می‌توانند از این ویژگی استفاده کنند.

## استفاده (Usage)

### باز کردن فرم ثبت سفارش

1. به داشبورد مدیریت بروید (شورتکد: `[tabesh_admin_dashboard]`)
2. روی دکمه **"ثبت سفارش جدید"** کلیک کنید
3. مودال فرم باز می‌شود

### انتخاب یا ایجاد مشتری

#### انتخاب کاربر موجود:
1. گزینه "انتخاب کاربر موجود" را انتخاب کنید
2. در کادر جستجو، نام، نام کاربری یا شماره موبایل را وارد کنید (حداقل ۲ کاراکتر)
3. از لیست نتایج، کاربر مورد نظر را انتخاب کنید
4. کاربر انتخاب شده نمایش داده می‌شود

#### ایجاد کاربر جدید:
1. گزینه "ایجاد کاربر جدید" را انتخاب کنید
2. شماره موبایل (۱۱ رقم، شروع با ۰۹) را وارد کنید
3. نام و نام خانوادگی را وارد کنید
4. روی دکمه "ایجاد کاربر" کلیک کنید
5. کاربر ایجاد شده به صورت خودکار انتخاب می‌شود

### تکمیل فرم سفارش

**فیلدهای الزامی:**
- عنوان کتاب
- قطع کتاب
- نوع کاغذ
- گرماژ کاغذ
- نوع چاپ
- تعداد صفحات
- تیراژ
- نوع صحافی
- نوع مجوز

**فیلدهای اختیاری:**
- گرماژ کاغذ جلد
- نوع سلفون
- آپشن‌های اضافی
- یادداشت

### محاسبه قیمت

1. بعد از تکمیل فیلدهای الزامی، روی دکمه **"محاسبه قیمت"** کلیک کنید
2. قیمت محاسبه شده نمایش داده می‌شود
3. قیمت به صورت خودکار با تغییر فیلدها بروزرسانی می‌شود

### تعیین قیمت دلخواه (اختیاری)

1. چک‌باکس "قیمت دلخواه" را فعال کنید
2. قیمت دلخواه را به ریال وارد کنید
3. قیمت نهایی بروزرسانی می‌شود

### ثبت سفارش

1. اطمینان حاصل کنید که:
   - یک کاربر انتخاب شده است
   - تمام فیلدهای الزامی پر شده‌اند
   - قیمت محاسبه شده است
2. روی دکمه **"ثبت سفارش"** کلیک کنید
3. پیام موفقیت نمایش داده می‌شود
4. صفحه رفرش می‌شود و سفارش جدید در لیست نمایش داده می‌شود

## نکات مهم

### امنیت
- تمام درخواست‌ها توسط nonce محافظت می‌شوند
- دسترسی فقط برای ادمین‌ها
- تمام ورودی‌ها sanitize می‌شوند

### یکپارچگی
- سفارشات ثبت شده توسط مدیر در تمام بخش‌های سیستم قابل مشاهده هستند
- اعلان‌ها (SMS و ایمیل) به صورت خودکار ارسال می‌شوند
- محاسبه قیمت با فرم مشتری یکسان است

### متادیتا
- فیلد `_created_by_admin` شناسه مدیر ایجادکننده را ذخیره می‌کند
- یادداشت خودکار "سفارش توسط مدیر ایجاد شد" به سفارش اضافه می‌شود

## رفع مشکلات رایج

### مودال باز نمی‌شود
- کش مرورگر را پاک کنید
- کنسول مرورگر را بررسی کنید
- فایل‌های CSS و JS را بررسی کنید

### جستجوی کاربر کار نمی‌کند
- حداقل ۲ کاراکتر وارد کنید
- اتصال اینترنت را بررسی کنید
- دسترسی ادمین را بررسی کنید

### قیمت محاسبه نمی‌شود
- تنظیمات افزونه را بررسی کنید
- تمام فیلدهای الزامی را پر کنید
- کنسول مرورگر را بررسی کنید

### سفارش ثبت نمی‌شود
- کاربر را انتخاب کنید
- تمام فیلدهای الزامی را پر کنید
- قیمت را محاسبه کنید
- لاگ‌های PHP را بررسی کنید

## API Endpoints

```
GET  /wp-json/tabesh/v1/admin/search-users-live?search={query}
POST /wp-json/tabesh/v1/admin/create-user
POST /wp-json/tabesh/v1/admin/create-order
```

تمام endpointها نیاز به nonce دارند و فقط برای ادمین‌ها قابل دسترسی هستند.

## فایل‌های مرتبط

```
includes/handlers/class-tabesh-admin-order-creator.php
templates/admin/admin-order-creator-modal.php
assets/js/admin-order-creator.js
assets/css/admin-order-creator.css
```

## اطلاعات بیشتر

مستندات کامل: `docs/ADMIN_ORDER_CREATOR.md`
راهنمای تست: `TESTING.md`

## پشتیبانی

برای گزارش مشکل یا پیشنهاد، با تیم توسعه تماس بگیرید.
